# A sample configuration file to setup ROBO

[hosts]
host1
host2
host3

## RAID Parameters will be created by gdeploy plugin
#[disktype]
#raid6

#[diskcount]
#4

#[stripesize]
#256

# Following RedHat subscription related configurations will  be created at run time by gdeploy plugin.
#[RH-subscription1]
#action=register
#username=<cdn-username>
#password=<cdn-password>
#pool=<pool>

#[RH-subscription2]
#action=disable-repos
#repos=

#[RH-subscription3]
#action=enable-repos
#repos=rhel-7-server-rpms,rh-gluster-3-for-rhel-7-server-rpms,rhel-7-server-rhv-4-mgmt-agent-rpms

#yum1 section will be updated by gdeploy plug-in based on the user input.
[yum1]
action=install

# Setup ntp on the servers before any other operations are done
# Disable the existing public servers
[shell1]
action=execute
# We need to encode the string with ''  to avoid truncation in ini module.
# More info at https://github.com/npm/ini/issues/44
command='sed -i 's/^\(server .*iburst\)/#\1/' /etc/ntp.conf'

# Add custom server
[update-file1]
action=add
dest=/etc/ntp.conf
line=server clock.redhat.com iburst

[service1]
action=enable
service=ntpd

[service2]
action=restart
service=ntpd

[shell2]
action=execute
command=vdsm-tool configure --force

# Brick related configurations will be added at runtime by gdeploy plug-in
[pv]
action=create
devices=vdc

[selinux]
yes

[service3]
action=stop
service=NetworkManager

[service4]
action=disable
service=NetworkManager

[service5]
action=start
service=glusterd
slice_setup=yes

[firewalld]
action=add
ports=111/tcp,2049/tcp,54321/tcp,5900/tcp,5900-6923/tcp,5666/tcp,16514/tcp
services=glusterfs

[update-file2]
action=edit
dest=/etc/nagios/nrpe.cfg
replace=allowed_hosts
line=allowed_hosts=host.redhat.com

[service6]
action=restart
service=nrpe

[script1]
action=execute
file=/usr/share/ansible/gdeploy/scripts/disable-gluster-hooks.sh

# Volume configurations will be updated at runtime by gdeploy plugin
[volume]
action=create
volname=engine
transport=tcp
replica=yes
replica_count=3
key=group,storage.owner-uid,storage.owner-gid,features.shard,features.shard-block-size,performance.low-prio-threads,cluster.data-self-heal-algorithm,cluster.locking-scheme,cluster.shd-wait-qlength,cluster.shd-max-threads,network.ping-timeout,user.cifs,performance.strict-o-direct,network.remote-dio
value=virt,36,36,on,512MB,32,full,granular,10000,8,30,off,on,off
brick_dirs=/rhgs/brick1/engine

# Host name wil be updated at runtime by gdeploy plugin. Make sure host number is valid one.
[yum2:host1]
action=install
packages=ovirt-engine-appliance

# [shell3]
# action=execute
# command=reboot
